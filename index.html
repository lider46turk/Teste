<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GAZ TEAM</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body {
    background:#050505;
    color:#e0e0e0;
    font-family:Courier New, monospace;
    margin:0;
    overflow-x:hidden;
}
body.pc-mode { font-size:16px; }
body.phone-mode { font-size:18px; }

.container { max-width:900px; margin:auto; padding:40px 20px; position:relative; z-index:2; }
body.phone-mode .container { max-width:100%; padding:30px 15px; }

/* MATRIX */
#matrix-canvas { position:fixed; inset:0; z-index:1; pointer-events:none; }

/* TOP BAR */
.top-bar { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }

/* HEADINGS */
h1 { color:#00ff9c; letter-spacing:4px; text-align:center; }

/* MENU */
.menu { text-align:center; margin:30px 0; }
.menu button {
    background:#000;
    color:#00ff9c;
    border:1px solid #00ff9c;
    padding:10px 18px;
    margin:6px;
    cursor:pointer;
}

/* SECTION */
.section { border-left:3px solid #00ff9c; padding-left:20px; margin-bottom:40px; }
.hidden { display:none; }

/* CHAT */
#chat-section { background:#111; border:1px solid #00cfff; padding:15px; }
#chat-messages {
    max-height:200px;
    overflow-y:auto;
    border:1px solid #00cfff;
    padding:10px;
    background:#000;
    color:#0f0;
    font-size:12px;
}
#chat-username, #chat-input {
    padding:6px;
    background:#000;
    border:1px solid #00cfff;
    color:#0f0;
}

/* POLL */
.poll-box {
    border:1px solid #00ff9c;
    padding:15px;
    margin-top:30px;
    background:#0b0b0b;
}
.poll-box button {
    margin:5px;
    padding:8px 16px;
    background:#000;
    color:#00ff9c;
    border:1px solid #00ff9c;
    cursor:pointer;
}
.poll-box button:hover {
    background:#00ff9c;
    color:#000;
}
.poll-status {
    margin-top:10px;
    color:#aaa;
    font-size:13px;
}
</style>
</head>

<body class="pc-mode">
<canvas id="matrix-canvas"></canvas>

<div class="container">

<h1>GAZ TEAM</h1>

<div class="menu">
<button onclick="showSection('home')">HOME</button>
<button onclick="showSection('chat')">CHAT</button>
</div>

<!-- HOME -->
<div id="home" class="section">
<h2>> WHO WE ARE</h2>
<pre>GAZ TEAM underground modding collective.</pre>

<!-- === NEW: POLL SYSTEM START === -->
<div class="poll-box">
<h3 id="poll-title">Anket Yükleniyor...</h3>
<button onclick="vote('yes')">EVET</button>
<button onclick="vote('no')">HAYIR</button>
<canvas id="pollChart" height="120"></canvas>
<div class="poll-status" id="poll-status"></div>
</div>
<!-- === NEW: POLL SYSTEM END === -->

</div>

<!-- CHAT -->
<div id="chat" class="hidden section">
<h2>> CHAT</h2>
<div id="chat-section">
<input id="chat-username" placeholder="İsmin">
<div id="chat-messages"></div>
<input id="chat-input" placeholder="Mesaj">
<button id="chat-send">SEND</button>
</div>
</div>

</div>

<script>
// SECTION
function showSection(id){
["home","chat"].forEach(s=>document.getElementById(s).classList.add("hidden"));
document.getElementById(id).classList.remove("hidden");
}

// MATRIX
const c=document.getElementById("matrix-canvas"),x=c.getContext("2d");
c.width=innerWidth;c.height=innerHeight;
let cols=Math.floor(c.width/20),y=Array(cols).fill(0);
setInterval(()=>{
x.fillStyle="rgba(5,5,5,0.07)";
x.fillRect(0,0,c.width,c.height);
x.fillStyle="#00ff9c";
x.font="15px monospace";
y.forEach((v,i)=>{
x.fillText(String.fromCharCode(33+Math.random()*94),i*20,v);
y[i]=v>c.height?0:v+20;
});
},50);

// FIREBASE
firebase.initializeApp({
apiKey:"AIzaSyBNv4kcJ2imTrGtpWbsiHlNbZael1_0XXc",
databaseURL:"https://gazteam-default-rtdb.firebaseio.com"
});
const db=firebase.database();

// CHAT
chat-send.onclick=()=>{
let u=chat-username.value,m=chat-input.value;
if(!u||!m)return;
db.ref("chat").push({u,m,t:new Date().toLocaleTimeString()});
chat-input.value="";
};
db.ref("chat").on("child_added",s=>{
let d=s.val();
chat-messages.innerHTML+=`<div>[${d.t}] ${d.u}: ${d.m}</div>`;
});

// === POLL SYSTEM ===
const pollRef=db.ref("poll");
let chart;

pollRef.on("value",s=>{
const p=s.val();
if(!p)return;
poll-title.innerText=p.title;
document.getElementById("poll-status").innerText=
Date.now()>p.end?"Anket kapandı":"Devam ediyor";

const data=[p.yes||0,p.no||0];
if(!chart){
chart=new Chart(document.getElementById("pollChart"),{
type:"bar",
data:{labels:["EVET","HAYIR"],datasets:[{data,backgroundColor:["#00ff9c","#ff0055"]}]},
options:{plugins:{legend:{display:false}}}
});
}else{
chart.data.datasets[0].data=data;
chart.update();
}
});

function vote(type){
if(localStorage.getItem("voted"))return alert("Zaten oy verdin");
pollRef.once("value",s=>{
const p=s.val();
if(Date.now()>p.end)return alert("Anket bitti");
pollRef.child(type).set((p[type]||0)+1);
localStorage.setItem("voted","1");
});
}
</script>
</body>
</html>
